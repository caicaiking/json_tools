<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>json_tools: Parsing json using JT::Tokenizer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">json_tools
   </div>
   <div id="projectbrief">json_tools is a single header only library meant to tokenize, parse and validate json.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Parsing json using <a class="el" href="class_j_t_1_1_tokenizer.html">JT::Tokenizer</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Tokenizing json <a class="el" href="class_j_t_1_1_tokenizer.html">JT::Tokenizer</a> can be used to extract tokens from a json stream. Tokens does not describe a full object, but only key-value pairs. So a object would be: "some key" and object start. Then the next token would be the first key value pair of that object. Then at some point the object is finished, and an object end value with no key would be the token.</p>
<p>Arrays would be expressed in a similar fashion, but the tokens would have no key, and each element in the array would be tokens with only a value specified.</p>
<p>The root object would be a token with no key data, but only object or array start</p>
<p>A crude example of this is viewed in <a class="el" href="simple_tokenize_8cpp-example.html">simple_tokenize.cpp</a> here: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="json__tools_8h.html">json_tools.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> json[] = R<span class="stringliteral">&quot;json(</span></div><div class="line"><span class="stringliteral">{</span></div><div class="line"><span class="stringliteral">    &quot;key&quot; : &quot;value&quot;,</span></div><div class="line"><span class="stringliteral">    &quot;number&quot; : 100,</span></div><div class="line"><span class="stringliteral">    &quot;boolean&quot; : true</span></div><div class="line"><span class="stringliteral">}</span></div><div class="line"><span class="stringliteral">)json&quot;;</span></div><div class="line"><span class="stringliteral"></span></div><div class="line"><span class="stringliteral"></span><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">    std::string key;</div><div class="line">    <span class="keywordtype">int</span> number;</div><div class="line">    <span class="keywordtype">bool</span> boolean;</div><div class="line">    JT::Error error;</div><div class="line">    <a class="code" href="class_j_t_1_1_tokenizer.html">JT::Tokenizer</a> tokenizer;</div><div class="line">    <a class="code" href="struct_j_t_1_1_token.html">JT::Token</a> token;</div><div class="line">    tokenizer.addData(json);</div><div class="line">    error = tokenizer.nextToken(token);</div><div class="line">    <span class="keywordflow">if</span> (token.value_type == JT::Type::ObjectStart) {</div><div class="line">        error = tokenizer.nextToken(token);</div><div class="line">        <span class="keywordflow">if</span> (error != JT::Error::NoError)</div><div class="line">            exit(1);</div><div class="line">        key = std::string(token.value.data, token.value.size);</div><div class="line">        error = tokenizer.nextToken(token);</div><div class="line">        <span class="keywordflow">if</span> (error != JT::Error::NoError)</div><div class="line">            exit(1);</div><div class="line">        <span class="keywordtype">char</span> *outpointer;</div><div class="line">        number = strtol(token.value.data,</div><div class="line">                        &amp;outpointer,</div><div class="line">                        10);</div><div class="line">        error = tokenizer.nextToken(token);</div><div class="line">        <span class="keywordflow">if</span> (error != JT::Error::NoError)</div><div class="line">            exit(1);</div><div class="line">        <span class="keywordtype">boolean</span> = std::string(token.value.data, token.value.size) == <span class="stringliteral">&quot;true&quot;</span>;</div><div class="line">        error = tokenizer.nextToken(token);</div><div class="line">        <span class="keywordflow">if</span> (error != JT::Error::NoError)</div><div class="line">            exit(1);</div><div class="line">        fprintf(stdout, <span class="stringliteral">&quot;Parsed data %s - %d - %d\n&quot;</span>, key.c_str(), number, boolean);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p>Tokenizing json in this way allows you parse arbitrary large json data. Also the tokenizer has mechanisms for asking for more data, making it easy to stream json data. Using this interface to parse json is a bit verbose and requires the application code to keep some extra state. json_tools also has functionality for parsing json data directly into c++ structures. This is done by adding some metadata to the structure, or by adding a template specialisation of a class. <a class="el" href="jt_struct.html">describes this</a> in more detail. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
